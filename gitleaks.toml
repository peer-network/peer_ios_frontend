# title = "Peer iOS Frontend Gitleaks Config"

[[rules]]
id = "ios-catch-all"
description = "Catch likely secrets in iOS/Swift code (Firebase, API keys, JWT, Apple tokens, etc.)"
regex = '''(?i)(ghp_[0-9A-Za-z]{36}|github_pat_[0-9A-Za-z_]{20,}|glpat-[0-9A-Za-z\-_]{20}|AKIA[0-9A-Z]{16}|ASIA[0-9A-Z]{16}|AIza[0-9A-Za-z\-_]{35}|AAAA[A-Za-z0-9_-]{5,}:[A-Za-z0-9_-]{20,}|sk_live_[0-9a-zA-Z]{24}|pk_live_[0-9a-zA-Z]{24}|eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9._-]+\.[A-Za-z0-9._-]+|-----BEGIN( RSA| DSA| EC| OPENSSH)? PRIVATE KEY-----)'''
tags = ["key", "secret", "frontend", "ios"]

[[rules]]
id = "ios-entropy-catch-all"
description = "Catch any high-entropy random strings (for unknown secrets)"
regex = '''[A-Za-z0-9\+=!@#$%^&*.-]{30,}'''
entropy = 4.0
tags = ["key", "secret", "frontend", "ios"]

[pathDenylist]
description = "Exclude noisy generated/test files for iOS builds"
regexes = [
  '''^Pods/.*''',
  '''^DerivedData/.*''',
  '''^build/.*''',
  '''^\.git/.*''',
  '''^\.github/workflows/.*''',
  '''^fastlane/.*''',
  '''^Tests?/.*''',
  '''^\.env.*$'''
]
